# 地图瓦片下载工具说明文档

## 项目简介
本工具是一个地图瓦片下载，提供浏览器下载版本和Node.js版本（Node版可能会被封禁，封禁后使用浏览器版本下载即可，但浏览器有并发限制下载慢）。
从指定地图服务（当前为Google地图）下载指定经纬度范围、指定缩放级别的地图瓦片，并自动处理文件校验、失败重试及日志记录功能。
网上有很多免费好用的下载工具，但无法修改源地址，下载速度慢，功能太多，修改需要编译源代码，比较麻烦。

## Node使用方法
1. 安装依赖：`npm install
2. 修改`DEFAULT_DATA`中的配置参数（可选）
3. 运行脚本：`node download_tiles.js`
4. 查看输出：成功瓦片存储在`outputDir`目录，失败记录在`failed_tiles.log`


## 浏览器使用方法
1. 使用Nginx或Live Server打开`index.html`
2. 输入经纬度范围、缩放级别、输出目录（可选）
3. 点击下载按钮
4. 查看输出：成功瓦片存储在`outputDir`目录，失败记录在`failed_tiles.log`


## 配置参数
通过`DEFAULT_DATA`对象配置下载范围及参数：
| 参数名       | 类型   | 说明                     | 默认值（郑州范围）          |
|--------------|--------|--------------------------|-----------------------------|
| `minLat`     | number | 最小纬度（南边界）       | 34.2667                     |
| `minLng`     | number | 最小经度（西边界）       | 112.7211                    |
| `maxLat`     | number | 最大纬度（北边界）       | 34.9895                     |
| `maxLng`     | number | 最大经度（东边界）       | 114.2209                    |
| `minZoom`    | number | 最小缩放级别             | 13                          |
| `maxZoom`    | number | 最大缩放级别             | 19                          |
| `outputDir`  | string | 瓦片输出目录（相对路径） | 'tiles'（生成`z/x/y.png`结构）|

## 注意事项
- 需要提前安装Node.js
- 谷歌地图可能会需要代理才能访问（有时不需要如同github一样）
- 使用谷歌地图是因为谷歌地图样式最好看，且最大支持23级缩放级别，可以自行更换
- 瓦片存储路径格式：`outputDir/z/x/y.png`（例：`tiles/13/567/890.png`）
- 并发数`concurrency`默认2000，可根据网络环境调整（过大可能导致请求被封禁）
- 每下载100000个瓦片会暂停5秒（防封禁机制，可根据实际情况调整，有时可能还是会被封禁但一般过2天就会自动解除）
- 支持断点续传：自动跳过已存在的完整瓦片文件
- 下载失败了先不用管，等下载完了再运行一次程序即可
